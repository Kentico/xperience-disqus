@using Disqus.Models
@model DisqusComponentViewModel

<link rel="stylesheet" href="/disqus.css" />
<script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
<link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="/disqus.js"></script>

<div id="disqus_thread" class="container">
    <span class="h2">@Model.Header</span>

    @if (Model.Exception != null)
    {
        await Html.RenderPartialAsync("_DisqusException.cshtml", Model.Exception);
    }
    else
    {
        if (!Model.Thread.IsClosed)
        {
            await Html.RenderPartialAsync("_DisqusPostForm.cshtml", new DisqusPost()
            {
                Thread = Model.Thread.Id
            });
        }
        else
        {
            <p>This thread is closed.</p>
        }

        foreach (var post in Model.Posts.Where(p => string.IsNullOrEmpty(p.Parent)))
        {
            await Html.RenderPartialAsync("_DisqusPost.cshtml", post);
        }
    }
</div>

@{
    await Html.RenderPartialAsync("_DisqusReportReason.cshtml");
}
